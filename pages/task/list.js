require("../../common/manifest.js");
require("../../common/vendor.js");
global.webpackJsonp([10],[,,,,,,,,,,,,,function(t,a,e){"use strict";var i=n(e(2)),s=n(e(14));function n(t){return t&&t.__esModule?t:{default:t}}Page((0,i.default)(s.default))},function(t,a,e){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var i=e(16),s=e.n(i),n=e(17),o=!1;var l=function(t){o||e(15)},r=e(0)(s.a,n.a,l,null,null);r.options.__file="..\\..\\..\\..\\data\\work\\ShareChat\\uniapp\\pages\\task\\list.vue",r.esModule&&Object.keys(r.esModule).some(function(t){return"default"!==t&&"__"!==t.substr(0,2)})&&console.error("named exports are not supported in *.vue files."),r.options.functional&&console.error("[vue-loader] list.vue: functional components are not supported with templates, they should use render functions."),a.default=r.exports},function(t,a){},function(t,a,e){"use strict";(function(t){Object.defineProperty(a,"__esModule",{value:!0}),a.default={data:function(){return{scrollLeft:0,tabIndex:0,orderby:"",myaction:"",myTabIndex:0,showMyTab:!1,showsearch:!1,popupShow:!1,popupID:null,popupData:{},searchtext:"",tasklist:[],pagination:{},page:0,page_size:10,loadingText:"",updatedTime:0,style:{pageHeight:0,contentViewHeight:0,footViewHeight:90,mitemHeight:0},tabBars:[{name:"最新度",id:"-created"},{name:"点赞度",id:"-thumbup_num"},{name:"收藏度",id:"-collect_num"},{name:"关注度",id:"-follow_num"},{name:"评论度",id:"-comment_num"},{name:"浏览度",id:"-browser_num"}],myTabBars:[{name:"所有的",id:""},{name:"我发的",id:"created"},{name:"我赞的",id:"thumbup"},{name:"我藏的",id:"collect"},{name:"我注的",id:"follow"},{name:"我评的",id:"comment"},{name:"我览的",id:"browser"}]}},onLoad:function(a){var e=t.getSystemInfoSync();this.style.pageHeight=e.windowHeight,this.style.contentViewHeight=e.windowHeight-t.getSystemInfoSync().screenWidth/750*100,this.reloadPageData()},onShow:function(){if(console.log("list.onShow",this),this.showMyTab=this.app.isLogin(),this.app.globalData.taskInfo){var t=this.app.globalData.taskInfo;console.log("list.onShow.updateTaskInfo"),console.log("list.onShow",t);for(var a=this.tasklist,e=0;e<a.length;e++){if(a[e].id==t.id){a[e]=t;break}}this.tasklist=a}},onPullDownRefresh:function(){console.log("onPullDownRefresh",this),this.reloadPageData(),t.stopPullDownRefresh()},onReachBottom:function(){console.log("onReachBottom",this),this.fetchServerData()},methods:{reloadPageData:function(){this.resetPageData(),this.fetchServerData()},resetPageData:function(){this.tasklist=[],this.page=0,this.pagination={},this.updatedTime=0,this.loadingText="",this.popupShow=!1},fetchServerData:function(){if(this.loadingText="加载更多...",this.pagination.pages<=this.page)this.loadingText="没有更多了";else{var t=this,a=t.page+1,e=t.page_size,i={page:a,page_size:e,keywards:this.searchtext,myaction:this.myaction,orderby:this.orderby},s=this.app;s.httpGet("/api/task/tasks",i,function(e){var i=e.data.data.pagelist,n=e.data.data.pagination,o=a;o=o<=n.pages?a:a-1,t.tasklist=t.tasklist.concat(i),t.pagination=n,t.page=o,t.updatedTime=s.getNowTime(),t.loadingText=""})}},inputSearch:function(t){console.log("inputSearch",t.detail.value.length),this.showsearch=t.detail.value.length>=1,this.searchtext=t.detail.value,this.showsearch||this.reloadPageData()},submitSearch:function(){console.log("submitSearch",this.searchtext),this.resetPageData(),this.fetchServerData()},incrTaskActionNum:function(t,a){for(var e=a+"_num",i=this.tasklist,s=0;s<i.length;s++){var n=i[s];if(n.id==t){n[e]=n[e]+1;break}}this.tasklist=i},gotoTaskInfo:function(a){console.log("gotoTaskInfo");var e=this,i=a.id,s="/pages/task/info?id="+i;t.navigateTo({url:s,success:function(t){e.incrTaskActionNum(i,"browser")}})},gotoUserInfo:function(a){var e="/pages/user/info?userId="+a.currentTarget.dataset.id;t.navigateTo({url:e})},tapTab:function(t){this.orderby=t.currentTarget.id,this.tabIndex=t.target.dataset.current,this.reloadPageData()},tapMyTab:function(a){this.app.isLogin()?(this.myaction=a.currentTarget.id,this.myTabIndex=a.target.dataset.current,this.reloadPageData()):t.showToast({icon:"none",title:"登陆后才能选择"})},popupUserInfo:function(t){console.log("popupUserInfo",t),this.popupShow=!0,this.popupID=t.id,this.popupData=t},closePopup:function(t){this.popupShow=!1},doFollowUser:function(a){var e=this,i={id:a.id};this.app.httpPost("/api/contact/follow",i,function(i){i.data.data.flag?t.showToast({title:"关注成功",icon:"none"}):t.showModal({content:"是否要撤回此操作？",success:function(t){t.confirm&&e.doUnFollowUser(a)}})})},doUnFollowUser:function(a){var e={id:a.id,cancel:!0};this.app.httpPost("/api/contact/follow",e,function(a){a.data.data.flag?t.showToast({title:"取消关注成功",icon:"none"}):t.showToast({title:"无需重复操作",icon:"none"})})},doApplyFriend:function(a){var e={id:a.id};this.app.httpPost("/api/contact/applyfriend",e,function(a){a.data.data.flag?t.showToast({title:"申请成功",icon:"none"}):t.showToast({title:"重复操作",icon:"none"})})}}}}).call(a,e(1).default)},function(t,a,e){"use strict";var i=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("view",{staticClass:"index"},[e("scroll-view",{staticClass:"swiper-tab",attrs:{id:"tab-bar","scroll-x":"","scroll-left":t.scrollLeft}},t._l(t.tabBars,function(a,i){return e("view",{key:a.id,class:["swiper-tab-list",t.tabIndex==i?"active":""],attrs:{id:a.id,"data-current":i,eventid:"Db0-0-"+i},on:{tap:t.tapTab}},[t._v(t._s(a.name))])})),e("scroll-view",{staticClass:"swiper-tab",attrs:{id:"tab-bar2","scroll-x":"","scroll-left":t.scrollLeft}},t._l(t.myTabBars,function(a,i){return e("view",{key:a.id,class:["swiper-tab-list",t.myTabIndex==i?"active":""],attrs:{id:a.id,"data-current":i,eventid:"I4F-1-"+i},on:{tap:t.tapMyTab}},[t._v(t._s(a.name))])})),e("view",{staticClass:"search-flex"},[e("view",{staticClass:"search-bar"},[e("input",{attrs:{type:"text",maxlength:"20",placeholder:"关键字查询, 多个空格分隔",eventid:"Nvm-2"},on:{input:t.inputSearch}}),t.showsearch?e("button",{staticClass:"search-btn",attrs:{eventid:"4ev-3"},on:{tap:t.submitSearch}},[t._v("搜索")]):t._e()],1)]),e("view",{staticClass:"uni-list"},[t._l(t.tasklist,function(a,i){return e("view",{key:a.id,staticClass:"uni-list-cell",attrs:{"hover-class":"uni-list-cell-hover"}},[e("view",{staticClass:"uni-media-list uni-list-cell-navigate"},[e("image",{staticClass:"uni-media-list-logo",attrs:{"lazy-load":"",src:a.creator.avatar,"hover-stop-propagation":"true",eventid:"5ZM-4-"+i},on:{tap:function(e){t.popupUserInfo(a.creator)}}}),e("view",{staticClass:"uni-media-list-body",attrs:{eventid:"POw-5-"+i},on:{tap:function(e){t.gotoTaskInfo(a)}}},[e("view",{staticClass:"uni-media-list-text-top"},[e("text",{staticStyle:{"text-align":"left"}},[t._v(t._s(a.title))]),e("text",{staticStyle:{"text-align":"right"}},[t._v(t._s(a.created))])]),e("view",{staticClass:"uni-media-list-text-bottom"},[e("text",{staticStyle:{"text-align":"left"}},[t._v(t._s(a.creator.nickname))]),e("text",{staticStyle:{"text-align":"right"}},[t._v("赞"+t._s(a.thumbup_num)+" 藏"+t._s(a.collect_num)+" 注"+t._s(a.follow_num)+" 评"+t._s(a.comment_num)+" 览"+t._s(a.browser_num))])])])]),e("view",{staticClass:"uni-navigate-right uni-navigate-badge",attrs:{eventid:"8Ug-6-"+i},on:{tap:function(e){t.gotoTaskInfo(a)}}},[e("text",{staticStyle:{color:"#CCCCCC"}},[t._v(t._s(">"))])])])}),t.loadingText?e("view",{staticClass:"loadmore"},[e("text",{staticClass:"loadmore-text"},[t._v(t._s(t.loadingText))])]):t._e()],2),e("navigator",{staticClass:"add-wrap",attrs:{"hover-class":"plus-hover",url:"/pages/task/add"}},[e("image",{attrs:{src:"/static/img/plus_new.png"}})]),t.popupShow?e("view",{staticClass:"grace-banner",attrs:{catchtouchmove:"move"}},[e("view",{staticStyle:{"justify-content":"flex-end"},attrs:{eventid:"eHp-7"},on:{tap:t.closePopup}},[t._m(0)]),e("view",{staticClass:"uni-list"},[e("view",{staticClass:"uni-list-cell",attrs:{"hover-class":"uni-list-cell-hover"}},[e("view",{staticClass:"uni-media-list "},[e("view",{staticClass:"uni-media-list-logo"},[e("image",{attrs:{src:t.popupData.avatar}})]),e("view",{staticClass:"uni-media-list-body"},[e("view",{staticClass:"uni-media-list-text-top"},[t._v("昵称: "+t._s(t.popupData.nickname))]),e("view",{staticClass:"uni-media-list-text-bottom uni-ellipsis"},[t._v("性别: "+t._s(t.popupData.sex_name))])])])])]),e("view",{staticStyle:{padding:"50upx 0","padding-bottom":"68upx"}},[e("view",{staticClass:"action-row"},[e("button",{staticClass:"mini-btn",attrs:{type:"primary",eventid:"Qg8-8"},on:{tap:function(a){t.doFollowUser(t.popupData)}}},[t._v("去关注")]),e("button",{staticClass:"mini-btn",attrs:{type:"primary",eventid:"y0h-9"},on:{tap:function(a){t.doApplyFriend(t.popupData)}}},[t._v("加好友")])],1)])]):t._e(),t.popupShow?e("view",{staticClass:"grace-mask",attrs:{catchtouchmove:"move"}}):t._e()],1)};i._withStripped=!0;var s={render:i,staticRenderFns:[function(){var t=this.$createElement,a=this._self._c||t;return a("view",{staticStyle:{"justify-content":"flex-end","text-align":"right",padding:"20upx"}},[a("text",{staticStyle:{"justify-content":"flex-center","text-align":"left",padding:"130upx"}},[this._v("他的信息")]),a("text",{staticClass:"uni-icon uni-icon-close"})])}]};a.a=s}],[13]);
//# sourceMappingURL=../../../.sourcemap/mp-weixin/pages/task/list.js.map